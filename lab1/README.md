# Lab 1: Dockerfile


### Dockerfile.bad
1. `FROM python:latest`: Огромный образ и неизвестная версия. В любой момент может сломаться
2. `root` по дефолту: дыра в безопасности
3. `COPY . .` в начале: убивает кеш при любом изменении в коде. Зависимости будут ставиться заново каждый раз
4. Куча `RUN`: каждый `RUN` - новый слой, образ пухнет

### Dockerfile.good
1. `FROM python:3.12-slim`: легкий образ, конкретная версия
2.  Non-root user: Создается `appuser` и работаем от него
3. Кеширование: cначала копируем `pyproject.toml` и ставим либы, а код копируем потом. Если код поменялся, либы не пересобираются
4. Multistage build: cборка в отдельном этапе

### Две плохие практики по использованию этого контейнера
-   Хранить данные внутри без вольюмов
-   Запускать всё в один контейнер (база + бэк + фронт). Один контейнер - один процесс

### Когда контейнеры не нужны
-   Нужен прямой доступ к специфичному железу
-   Строгая изоляция 

### Как запустить

### Плохой вариант
```bash
docker build -t lab1-bad -f lab1/Dockerfile.bad lab1
docker run -d -p 8000:8000 lab1-bad
```

### Хороший вариант
```bash
docker build -t lab1-good -f lab1/Dockerfile.good .

docker run -d \
  -p 8032:8000 \
  -v /app/data \
  lab1-good
```

